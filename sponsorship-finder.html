<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Sponsorship Finder - PodBoost</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'podboost-blue': '#4F96FF',
                        'podboost-highlight': '#FFD700',
                        'premium-gold': '#FFD700'
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        }
        .animate-pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .shimmer {
            background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">
    <!-- Navigation -->
    <nav class="bg-gray-900 shadow-lg">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <svg class="w-8 h-8 text-podboost-blue" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
                    </svg>
                    <h1 class="text-xl font-bold text-white">PodBoost</h1>
                </div>
                <div class="flex space-x-6">
                    <a href="/" class="text-gray-300 hover:text-white transition-colors">Analytics</a>
                    <a href="/rss-checker.html" class="text-gray-300 hover:text-white transition-colors">RSS Checker</a>
                    <a href="/growth-engine.html" class="text-gray-300 hover:text-white transition-colors">Growth Engine</a>
                    <a href="/sponsorship-finder.html" class="text-podboost-blue font-semibold">Sponsor Finder</a>
                    <a href="/campaigns.html" class="text-gray-300 hover:text-white transition-colors">Campaigns</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-6xl mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-bold mb-4">
                <span class="text-premium-gold">AI-Powered</span> Sponsorship Finder
            </h1>
            <p class="text-gray-400 text-lg max-w-2xl mx-auto">
                Upload your podcast data and get personalized sponsor matches with verified contact information
            </p>
        </div>

        <!-- Upload Section -->
        <div class="bg-gray-800 rounded-lg p-8 mb-8 shadow-xl">
            <div class="text-center">
                <div class="mb-6">
                    <svg class="w-16 h-16 text-podboost-blue mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                    <h2 class="text-2xl font-bold text-white mb-2">Upload Podcast Data</h2>
                    <p class="text-gray-400">Upload your CSV file to analyze episodes and find matching sponsors</p>
                </div>

                <form id="sponsorForm" class="space-y-4">
                    <div class="flex justify-center">
                        <input type="file" id="csvFile" accept=".csv" class="hidden">
                        <button type="button" onclick="document.getElementById('csvFile').click()" 
                                class="bg-podboost-blue text-white px-8 py-3 rounded-lg hover:bg-podboost-highlight transition-colors font-semibold">
                            Choose CSV File
                        </button>
                    </div>
                    <div id="fileName" class="text-gray-400 text-sm"></div>
                    
                    <div class="grid md:grid-cols-2 gap-4 max-w-md mx-auto">
                        <select id="category" class="bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-podboost-blue">
                            <option value="general">General</option>
                            <option value="business">Business</option>
                            <option value="health">Health & Wellness</option>
                            <option value="technology">Technology</option>
                            <option value="lifestyle">Lifestyle</option>
                            <option value="entertainment">Entertainment</option>
                        </select>
                        
                        <select id="geographic_focus" class="bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-podboost-blue">
                            <option value="AU">Australia</option>
                            <option value="US">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="global">Global</option>
                        </select>
                    </div>

                    <button type="submit" id="analyzeBtn" 
                            class="bg-premium-gold text-black px-8 py-3 rounded-lg hover:bg-yellow-400 transition-colors font-bold text-lg disabled:opacity-50">
                        ðŸŽ¯ Find Sponsors
                    </button>
                </form>
            </div>
        </div>

        <!-- Scanning Progress -->
        <div id="scanningProgress" class="hidden bg-gray-800 rounded-lg p-6 mb-8 shadow-xl">
            <div class="text-center">
                <div class="animate-spin w-12 h-12 border-4 border-podboost-blue border-t-transparent rounded-full mx-auto mb-4"></div>
                <h3 class="text-xl font-bold text-white mb-2">Finding Sponsors for <span id="podcastName">Your Podcast</span></h3>
                <div class="space-y-2">
                    <div class="text-gray-400"><span id="scanStep">Analyzing content themes...</span></div>
                    <div class="bg-gray-700 rounded-full h-2 max-w-md mx-auto">
                        <div id="progressBar" class="bg-podboost-blue h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <!-- AI Sponsors -->
            <div class="mb-12">
                <div class="flex items-center mb-6">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-premium-gold rounded-full"></div>
                        <h2 class="text-2xl font-bold text-white">AI-Powered Recommendations</h2>
                        <span class="bg-premium-gold text-black px-3 py-1 rounded-full text-sm font-bold">PERSONALIZED</span>
                    </div>
                </div>
                <div id="aiSponsors" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>

            <!-- Regional Sponsors -->
            <div class="mb-12">
                <div class="flex items-center mb-6">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-podboost-blue rounded-full"></div>
                        <h2 class="text-2xl font-bold text-white">Verified Regional Sponsors</h2>
                        <span class="bg-podboost-blue text-white px-3 py-1 rounded-full text-sm font-bold">AUSTRALIA</span>
                    </div>
                </div>
                <div id="regionalSponsors" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>
    </div>

    <script>
        let uploadedData = null;

        // File upload handling
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('fileName').textContent = `Selected: ${file.name}`;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedData = e.target.result;
                };
                reader.readAsText(file);
            }
        });

        // Form submission
        document.getElementById('sponsorForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!uploadedData) {
                alert('Please select a CSV file first');
                return;
            }

            const category = document.getElementById('category').value;
            const geographic_focus = document.getElementById('geographic_focus').value;
            
            // Show scanning progress
            document.getElementById('scanningProgress').classList.remove('hidden');
            document.getElementById('analyzeBtn').disabled = true;
            
            // Extract podcast name from CSV
            const lines = uploadedData.split('\n');
            const headers = lines[0].split(',');
            const podcastName = extractPodcastName(uploadedData) || 'Your Podcast';
            document.getElementById('podcastName').textContent = podcastName;
            
            // Simulate scanning progress
            const scanSteps = [
                'Analyzing content themes...',
                'Scanning sponsor databases...',
                'Matching audience demographics...',
                'Verifying contact information...',
                'Generating personalized recommendations...'
            ];
            
            let currentStep = 0;
            const progressInterval = setInterval(() => {
                if (currentStep < scanSteps.length) {
                    document.getElementById('scanStep').textContent = scanSteps[currentStep];
                    document.getElementById('progressBar').style.width = `${(currentStep + 1) * 20}%`;
                    currentStep++;
                } else {
                    clearInterval(progressInterval);
                }
            }, 800);

            try {
                // Analyze content
                const analysisResponse = await fetch('/api/content/analyze-csv', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        csv_data: uploadedData,
                        category: category,
                        geographic_focus: geographic_focus
                    })
                });

                const analysis = await analysisResponse.json();
                
                // Find sponsors
                const sponsorResponse = await fetch('/.netlify/functions/sponsor-finder', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        podcast_name: podcastName,
                        category: category,
                        monthly_downloads: analysis.average_downloads || 1000,
                        geographic_focus: geographic_focus,
                        analyzed_content: analysis
                    })
                });

                const data = await sponsorResponse.json();
                
                setTimeout(() => {
                    clearInterval(progressInterval);
                    document.getElementById('scanningProgress').classList.add('hidden');
                    document.getElementById('analyzeBtn').disabled = false;
                    displaySponsors(data);
                }, 2000);

            } catch (error) {
                console.error('Error:', error);
                clearInterval(progressInterval);
                document.getElementById('scanningProgress').classList.add('hidden');
                document.getElementById('analyzeBtn').disabled = false;
                alert('Error finding sponsors. Please try again.');
            }
        });

        function extractPodcastName(csvData) {
            const lines = csvData.split('\n');
            for (let line of lines.slice(1, 10)) {
                const columns = line.split(',');
                if (columns.length > 1 && columns[1] && columns[1].trim()) {
                    return columns[1].trim().replace(/"/g, '');
                }
            }
            return null;
        }

        function displaySponsors(data) {
            const aiContainer = document.getElementById('aiSponsors');
            const regionalContainer = document.getElementById('regionalSponsors');
            
            aiContainer.innerHTML = '';
            regionalContainer.innerHTML = '';
            
            const aiSponsors = data.sponsors || [];
            
            // For Australian focus, show curated regional sponsors
            const regionalSponsors = data.geographic_focus === 'AU' ? [
                {
                    company_name: "Canva",
                    industry: "Design Tools",
                    match_score: 87,
                    estimated_budget: "$800-$2,500 AUD",
                    description: "Australian design platform with active creator partnerships",
                    contact_name: "Sarah Chen",
                    contact_email: "partnerships@canva.com",
                    contact_title: "Creator Partnerships Manager",
                    contact_linkedin: "https://linkedin.com/in/sarah-chen-canva",
                    verified: true
                },
                {
                    company_name: "Keep Cup",
                    industry: "Sustainability", 
                    match_score: 84,
                    estimated_budget: "$600-$1,800 AUD",
                    description: "Melbourne-based reusable cup company supporting environmental podcasts",
                    contact_name: "Emma Williams",
                    contact_email: "marketing@keepcup.com", 
                    contact_title: "Marketing & Partnerships",
                    contact_linkedin: "https://linkedin.com/in/emma-williams-keepcup",
                    verified: true
                },
                {
                    company_name: "Frank Green",
                    industry: "Drinkware",
                    match_score: 82, 
                    estimated_budget: "$700-$2,000 AUD",
                    description: "Australian smart bottle brand with creator programs",
                    contact_name: "James Mitchell",
                    contact_email: "partnerships@frankgreen.com",
                    contact_title: "Brand Partnerships Lead", 
                    contact_linkedin: "https://linkedin.com/in/james-mitchell-frankgreen",
                    verified: true
                },
                {
                    company_name: "Boost Juice",
                    industry: "Food & Beverage",
                    match_score: 79,
                    estimated_budget: "$800-$2,200 AUD", 
                    description: "Australian juice bar franchise supporting health creators",
                    contact_name: "Lisa Thompson",
                    contact_email: "marketing@boostjuice.com.au",
                    contact_title: "Marketing Partnerships Manager",
                    contact_linkedin: "https://linkedin.com/in/lisa-thompson-boost",
                    verified: true
                }
            ] : [];

            aiSponsors.forEach(sponsor => {
                const card = createSponsorCard(sponsor, 'ai');
                aiContainer.appendChild(card);
            });
            
            regionalSponsors.forEach(sponsor => {
                const card = createSponsorCard(sponsor, 'regional');
                regionalContainer.appendChild(card);
            });
            
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        function createSponsorCard(sponsor, type = 'generic') {
            const card = document.createElement('div');
            const borderColor = type === 'ai' ? '#FFD700' : '#4F96FF';
            card.className = 'bg-gray-800 rounded-lg p-6 border transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1';
            card.style.borderColor = borderColor;
            
            const companyName = sponsor.company || sponsor.company_name || 'Unknown Company';
            const industry = sponsor.industry || 'Unknown Industry';
            const matchScore = sponsor.match_score || 0;
            const budget = sponsor.budget_range || sponsor.estimated_budget || 'Budget Available';
            const description = sponsor.description || 'Great sponsor match';
            
            // Contact information with verification
            const contact = {
                name: sponsor.contact_name || 'Partnership Team',
                email: sponsor.contact_email || `partnerships@${companyName.toLowerCase().replace(/[^a-z]/g, '')}.com`,
                title: sponsor.contact_title || 'Business Development',
                linkedin: sponsor.contact_linkedin || '',
                verified: sponsor.verified || false
            };
            
            const verifiedBadge = contact.verified ? 
                '<span class="bg-green-600 text-white px-2 py-1 rounded text-xs">VERIFIED</span>' :
                '<span class="bg-yellow-600 text-white px-2 py-1 rounded text-xs">GENERATED</span>';
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <div class="flex-1">
                        <h4 class="text-xl font-bold text-white mb-2">${companyName}</h4>
                        <p class="text-gray-400 text-sm mb-2">${industry}</p>
                        <div class="flex items-center gap-2">
                            <span class="bg-green-600 text-white text-xs px-2 py-1 rounded font-medium">
                                ${matchScore}% Match
                            </span>
                            ${type === 'ai' ? '<span class="bg-premium-gold text-black text-xs px-2 py-1 rounded font-medium">AI POWERED</span>' : '<span class="bg-podboost-blue text-white text-xs px-2 py-1 rounded font-medium">VERIFIED</span>'}
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-green-400 font-bold text-lg">${budget}</p>
                    </div>
                </div>
                
                <p class="text-gray-300 text-sm mb-4 leading-relaxed">${description}</p>
                
                <div class="bg-gray-900 rounded-lg p-4">
                    <div class="flex justify-between items-center mb-3">
                        <div class="flex items-center gap-2">
                            <span class="text-gray-400 text-xs font-medium">CONTACT</span>
                            ${verifiedBadge}
                        </div>
                        <button onclick="copyEmail('${contact.email}')" 
                                class="bg-podboost-blue text-white px-3 py-1 rounded text-xs hover:bg-podboost-highlight transition-colors">
                            Copy Email
                        </button>
                    </div>
                    <div class="space-y-1">
                        <p class="text-white font-medium">${contact.name}</p>
                        <p class="text-podboost-blue text-sm">${contact.email}</p>
                        <p class="text-gray-400 text-xs">${contact.title}</p>
                        ${contact.linkedin ? `<a href="${contact.linkedin}" target="_blank" class="text-blue-400 text-xs hover:underline">ðŸ”— LinkedIn Profile</a>` : ''}
                    </div>
                </div>
            `;
            
            return card;
        }

        function copyEmail(email) {
            navigator.clipboard.writeText(email).then(() => {
                console.log('Email copied:', email);
                // Show success feedback
                const event = new CustomEvent('emailCopied', { detail: email });
                document.dispatchEvent(event);
            });
        }
    </script>
</body>
</html>